<html>

<head>
	<link rel="stylesheet" type="text/css" href="user_chat.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
    <title>Messages From </title>
</head>
<script>
	// alert(document.cookie);
    var testCookie = document.cookie;
    var partsOfCookie = testCookie.split(',');
    // alert(partsOfCookie[1]);
    var dummyUser = ({
        UserID: 1,//partsOfCookie[0],
        UserName: "Alex"//partsOfCookie[1]
    });
	var contact = ({
		UserID: 2,
		UserName: "Steve"
	});

	$.ajax({
		type : 'GET',
		url: '/BackEnd/getMessages/',
		data: {UserID1: dummyUser.UserID, UserID2: contact.UserID},
		success: function(data,status) {
			var string = "";
            for (var i = 0; i < data.length; i++) {
                string += data[i].UserID1 + ": " + data[i].Message + "<br>";
            }
            	document.getElementById("chatbox").innerHTML = string;	
            }       
	});
	
	
</script>

<body>

	    <div>	     
	       <label>Chatroom</label> 
	        <br>
	        </br>
	        <div id="chatbox"></div>
	        <script>
	            // filled matchedUser with UserName of who messages are being sent to
	            // document.getElementById("UserName").innerHTML = dummyUser.UserName;
	        </script>
	    </div>
    <form id="send">
    	<div>
         	<input id="message" type="text" placeholder="Enter message" name="messageBox" required>
            </div>
            <button id="button2" type="submit">Send</button>
    </form>
    <script>
        var socket = io.connect();

        $("form").submit(function(event) {
            //$( "#button1" ).prop( "disabled", true );        
            var user = document.getElementById("UserID").value;
            event.preventDefault();
            socket.emit("hello", {
                UserID: user
            });
        });

        $("#send").submit(function(event) {
            //$( "#button2" ).prop( "disabled", true );        
            var user = document.getElementById("UserID_chat").value;
            var message = document.getElementById("message").value;
            event.preventDefault();
            socket.emit("send", {
                UserID: user,
                Message: message
            });
        });
        socket.on('message', function(data) {
            alert(data.message);
        });
    </script>
</body>

</html>