<html>

<head>
    <link rel="stylesheet" type="text/css" href="create_account.css">
    <title>Edit Account Info</title>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
</head>

<body>

    <h1>Edit Account Information</h1>

    <script>
        // alert(document.cookie);
        var testCookie = document.cookie;
        var partsOfCookie = testCookie.split(',');
        // alert(partsOfCookie[1]);
        var dummyUser = ({
            UserName: partsOfCookie[1],
            Password: partsOfCookie[2],
            Picture: null,
            Birthday: partsOfCookie[3],
            Gender: partsOfCookie[4],
            GenderInto: partsOfCookie[5],
            Location: null,
            InARelationship: false
        });
    </script>


    <form id="getAnID" action="/BackEnd/editPassword/" onsubmit="return myFunction()" method="post">
        <div class="container">

            <label><b>Enter old password</b></label>
            <input id="oldPass" type="password" placeholder="Enter old Password" name="oldPassword" required>

            <label><b>Enter new password</b></label>
            <input id="pass1" type="password" placeholder="Enter new Password" name="newPassword" required>

            <label><b>Re-enter new password</b></label>
            <input id="pass2" type="password" placeholder="Enter new Password again" required>


            <script>
                function myFunction() {
                    var oldPass = document.getElementByID('oldPass').value;
                    var pass1 = document.getElementById("pass1").value;
                    var pass2 = document.getElementById("pass2").value;
                    var ok = true;

                    if (pass1 != pass2) {
                        //alert("Passwords Do not match");
                        document.getElementById("pass1").style.borderColor = "#E34234";
                        document.getElementById("pass2").style.borderColor = "#E34234";
                        ok = false;
                    } else if (oldPass != dummyUser.Password) {
                        document.getElementById("oldPass").style.borderColor = "E34234";

                    } else {
                        // alert("Passwords Match!!!");
                    }
                    return ok;
                }
                $("#getAnID").submit(function(event) {

                    event.preventDefault();


                    var $form = $(this),
                        Password = document.getElementById("pass1").value,

                        var posting = $.post("/BackEnd/editPassword/", {
                            Password: Password,
                        });

                    posting.done(function(data) {
                        alert("ID is " + data[0].UserID);
                        // obj = jQuery.parseJSON(data);
                        if (data.UserID != null) {
                            // alert("userID not null");
                            document.cookie = data[0].UserID + "," + UserName + "," + Password + "," + Birthday + "," + Gender + "," + GenderInto + "," + "path=/";
                            location.replace('/account_page.htm');
                        }
                    });
                });
            </script>


            <button type="submit">Submit Password Change</button>
        </div>
    </form>

 	<form id="addPref">
 	
            <label><b>Add Preferences</b></label>
            <input id="add" type="text" placeholder="Enter one preference you would like to add and hit submit" name="Name" required>

        <!--add send info to server with name and userid-->

        <button type="submit">Submit New Preference</button>

            <script>
                $("#addPref").submit(function(event) {
                    alert("Hello world");
		    var add = document.getElementById("add").value;
                    var dCookie = document.cookie;
                    var id = dCookie.split(';', 1);
                    
                    event.preventDefault();

                    var $#addpref = $(this),
                    Name = add,
                    UserID = id;

                    var posting = $.post("/BackEnd/addUserPref/", {
                      Name: Name,
                      UserID: UserID
                    });

                    posting.done(function(data) {
                        alert("Preference Sent");
                    });
                });
            </script>

    </form>

    <form id= "removePref">

        <label><b>Remove Preferences</b></label>
        <input type="text" placeholder="Type one prefernce at a time to remove and hit submit" name="" required>

        <!--add send info to server with name of remove preference and userid-->

        <button type="submit">Remove Preference</button>
    </form>


</body>

</html>
