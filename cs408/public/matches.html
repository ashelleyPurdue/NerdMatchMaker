<html>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>

<head>
    <link rel="stylesheet" type="text/css" href="matches.css">
    <title>Matches</title>
</head>

<body>

    <h1>Matches</h1>

    <!--<div id="block">
        <form id="blockUserDiv" name="block">


        </form>
    </div>-->

    <script>
        // alert(document.cookie);
        var testCookie = document.cookie;
        var partsOfCookie = testCookie.split(',');
        // alert(partsOfCookie[1]);
        var dummyUser = ({
            UserID: partsOfCookie[0], //partsOfCookie[0],
            UserName: partsOfCookie[1] //partsOfCookie[1]
        });


        $.ajax({
            type: 'GET',
            url: '/BackEnd/getMatches/',
            data: {
                UserID1: dummyUser.UserID
            },
            success: function(data, status) {
                for (var i = 0; i < data.length; i++) {
                    var newDiv = document.createElement("div");
                    // var formDiv = document.createElement("form");
                    // formDiv.id = "blockUserDiv" + i;
                    // // var blockForm = document.createElement("form");
                    // // blockForm.id = "blockUser";
                    // // newDiv.getElementsByTagName("button")[0];
                    var newContent = document.createTextNode("UserName: " + data[i].UserName + " " + data[i].UserID);
                    // var messageButton = document.createElement("button");
                    // var blockButton = document.createElement("button");
                    // blockButton.type = "submit";
                    // blockButton.name = "blockedUser";
                    // // blockButton.tagName = "blockedUser";
                    // // blockButton.id = "blockedUser";
                    // blockButton.value = data[i].UserID;
                    // messageButton.innerHTML = "Message";
                    // blockButton.innerHTML = "Block " + data[i].UserName;
                    newDiv.appendChild(newContent); //add the text node to the newly created div. 
                    // newDiv.appendChild(messageButton);
                    // formDiv.appendChild(blockButton); // add the button into each users match

                    // // add the newly created element and its content into the DOM 
                    var currentDiv = document.getElementById("divUser");
                    document.body.insertBefore(newDiv, currentDiv);
                    // document.body.insertBefore(formDiv, currentDiv);
                    //$form = $('<form></form>');
                    //$form.append('<input type = "submit" value = "button">');

                    $temp = $('<form>', {});
                    $temp.append('<button><input type = "submit" value = "UserName:+' + data[i].UserName + ' "></button>');
                    $temp.append('<input type = "hidden" name = "UserID" value = ' + data[i].UserID + '>');
                    $temp.appendTo(document.body);
                    $temp.submit(function(event) {
                        var text = $(this).find('input[name="UserID"]').val();
                        alert(text);
                        event.preventDefault();

                        var $blockUser = $(this),
                            UserID1: dummyUser.UserID,
                            UserID2: text;

                        var posting = $.post("/BackEnd/blockUser/", {
                            UserID1: UserID1,
                            UserID2: UserID2
                        });

                        posting.done(function(data) {
                            alert("blocked");
                        });


                    });

                }
                // document.body.removeChild(blockForm);
            }
        });

        /*$('#blockUserDiv0').submit(function(event) {
            alert("called");
            var user = document.getElementsByName("blockedUser");
            alert("blocking user " + user[0].value);
            var blockedU = user[0].value;
            event.preventDefault();

            var $blockUser = $(this),
                UserID1: dummyUser.UserID,
                UserID2: blockedU;

            var posting = $.post("/BackEnd/blockUser/", {
                UserID1: UserID1,
                UserID2: UserID2
            });

            posting.done(function(data) {
                alert("blocked");
            });
        });*/
    </script>








    <!--
</body>

<div class="container" style="background-color:#f1f1f1">
    <span class="newact"> <a href="/edit_account_info.htm">Edit Account Information</a></span>
</div>-->



</html>